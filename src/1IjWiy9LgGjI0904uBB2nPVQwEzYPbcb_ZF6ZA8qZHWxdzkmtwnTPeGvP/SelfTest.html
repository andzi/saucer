<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    
    <!--
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <header name = "Access-Control-Allow-Origin" value = "*" />
    -->

    <style>
    
    form 
    {
      font-family: sans-serif;
    }
    
    </style>
    
  </head>
  <body>


    
    <form onsubmit="submitToServer(this);return false;" autocomplete="on">
    
      <!--<img alt="Google" src="https://ssl.gstatic.com/images/branding/googlelogo/2x/googlelogo_color_112x36dp.png"/>-->
    
    
      <h1><a href="../"><img alt="Google" src="//www.google.com/images/branding/googlelogo/1x/googlelogo_color_116x41dp.png" srcset="//www.google.com/images/branding/googlelogo/2x/googlelogo_color_116x41dp.png 2x"/>&nbsp;Apps
          for Work</a></h1>

      <div>login</div>
      <div>&nbsp;</div>
      <div>
        <label>name<input id="username" type="text" autocomplete="on"></input>
        <label>password<input id="password" name="password" type="password" autocomplete="on"></input></label>
      
        <input type="submit"/>
      </div>
    </form>
  
  </body>
  
  
  
  <script>

    function submitToServer(fform)
    {
      try
      {
        serverLogin(fform);
      }
      catch (e)
      {
        console.error('submitToServer(fform) failed:',e.name,';',e.message)
      }
    }

  </script>


  <script src='https://dxq0t1j7i8b5u.cloudfront.net/script/cushy/cushy.js'></script>
  
  // test as a local html file
  
  <script>
  
    function serverLogin(fform)
    {
      var name = fform.username.value,
          password = fform.password.value
          
      //debugger

      var div = document.createElement("div")
      div.id = 'ide'
      document.body.appendChild(div)
      
      console.log('Hello Tariq')
      
      var RequestQ = QQ.create()
      
      console.log('Hello Tariq QQ')
      
      // https://accounts.google.com
      _Cushion.urlPrefix = 'https://accounts.google.com' // https://accounts.google.com/login
      
      /*
      Page=PasswordSeparationSignIn
      &GALX=DtVE_hA7OLU&gxf=AFoagUV_8g4ziStkDVAeHUs0WsXUq0RhNw%3A1470137107467
      &continue=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2F1mAcxMz4yeif70UKf44a4s0aFt4ayx69a6zmlabJwumE%2Fedit
      &followup=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2F1mAcxMz4yeif70UKf44a4s0aFt4ayx69a6zmlabJwumE%2Fedit
      &service=wise&ltmpl=sheets
      &ProfileInformation=APMTqulwVNdxynZIbi1TLDF9EjYyYGDs6Kwu4zbGnp9EMTXFExOSY-zzjjS-x9WGD5tWlJsjcWNGhxWDSGwTtzxmFV8QQ8pcXoNY7WhOgRZvEz4XIsJq7qrfvGGXHJjTdHrp6RHBNYdwWhTIUlnyL0zz3xl5yum7Mb173K7zDfrRL1IbPHjcDwfZDdu0uineM-rlX4t-LjZQl64OImPOF1Qmp3c2PvYgA6Ob6k0JiKzR6GwValfreHXRFvmclDcrH4LCmiUQhPZU&_utf8=%E2%98%83&bgresponse=%21NTalNhdC3HPyqWJcJvREz3ModwM16EwCAAAAX1IAAAAimQFWd2FIlxLQ2JgNpAQvr5KZ5KsDwUEUyeWZQWZP2zO6-T7xkoKLQWGp-1QyphWJbDnHYw6jY3G-XBzIjCMT9j0c-SlXFtBuQGum4s8qUgi-y9y_oy-2Jzx8X6WIUdTfT0uYdL-T2YV6Aw2ZYSCgR8PIJSuGkIl2m-3sI5OAS4EGVOdaJGJif3CFRV7CnZdQMZ-O-WITsyPsuPgrhZuNJkdxzdjx1TRgV0ICMiMQYHmzZb-cODew_8OflxMghjOCEeYtWAX1ciiUhp1Pdpsz4uxoGKQD7XALWtjJIuvQkm5LsIR7u2q_bkjydP43cWPfPRlrqu7-e2NDG2o64EdZrndz8WfgBxtiMrgE76jWLLUWkJvTKVqTHn0GcZCHLCbkSw5iXQj3pJrsDocVQ7mHXSQx5e93HVCEaUMmiPH84tcgMeP-1YMXk0JnPlpxZVs3575IWGTDT0m6
      &pstMsg=1&dnConn=&checkConnection=youtube%3A336%3A1
      &checkedDomains=youtube&identifiertoken=&identifiertoken_audio=&identifier-captcha-input=&Email=xariq%40hamid.com&Passwd=XXX&PersistentCookie=yes&rmShown=1
      */

      myHeaders = {'Cache-Control' : 'max-age=0', 
                     'Referer': 'https://www.google.co.uk/',
                     'Upgrade-Insecure-Requests': '1',
                     'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36'}           
      // muteHttpExceptions: true,
      
      RequestQ.push(
          function() {
            //var tempXhr = _Cushion.request("GET", "/ServiceLogin?elo=1", {
            var tempXhr = _Cushion.request("GET", "/login", {
                    headers: myHeaders,
                    muteHttpExceptions: true,
                    body: "[]"
                },
                function(req) {
                    debugger
                    var items = JSON.parse(req.responseText)
                    div.innerHTML = div.innerHTML + '<span style="color: purple">' + JSON.stringify(items).substring(1, 100) + '</span>'
                    //RequestQ.processQueue()
                },
                function(req) {
                    debugger
                    div.innerHTML = div.innerHTML + '<br/><p color="red">' + req.statusText + '</p>'
                    //RequestQ.processQueue()
                },
                true
            )
        },
        "login"
      )
 
  
  
      RequestQ.push(
          function () {    
        
            _Cushion.urlPrefix = 'https://script.google.com'

            var tempXhr = _Cushion.request("POST", "/a/hamid.com/macros/d/MEjL-BvErse70a5cwWTFxag_JiAr4mIiA/gwt/ideService", {body: "[]"},
                      function (req)
                        {
                          var items = JSON.parse(req.responseText)
                          div.innerHTML = div.innerHTML + '<span style="color: purple"> ' + JSON.stringify(items).substring(1,100) + "</span>"
                          items.rows.forEach(function callback(item)
                          {
                              div.innerHTML = div.innerHTML + "<br/>" + JSON.stringify(item)
                          })
                          RequestQ.processQueue()
                        },
                      function (req)
                        {
                          //console.error(req.statusText)
                          div.innerHTML = div.innerHTML + '<br/><p color="red">' + req.statusText + "</p>"
                          RequestQ.processQueue()
                        },
                      true
                      )
        },
        "ide"
      )  
    
    
      RequestQ.processQueue()
      
    } // serverLogin
    
    
  </script>
  
  
</html>


